<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Multi-Task Time Tracker</title>

	<!--
		MTTT - Multi-Task Time Tracker
		================================

		ARCHITECTURE OVERVIEW:
		This is a single-page application (SPA) for local time tracking. It operates
		entirely in the browser with a local Node.js server providing data persistence.

		DESIGN PHILOSOPHY - Single-User, Local-First:
		- No authentication or user accounts
		- All data stored locally in JSON files
		- Complete privacy (no external network requests except CDNs)
		- Survives browser/system restarts via server-side state persistence

		MODULAR STRUCTURE:
		The application uses ES6 modules for clean separation of concerns:
		- app.js: Main orchestrator, initializes everything
		- state.js: Centralized state management
		- api.js: Server communication layer
		- ui.js: DOM manipulation and user interactions
		- reports.js: Chart generation and analytics
		- utils.js: Shared utility functions
		- constants.js: Configuration values

		EXTERNAL DEPENDENCIES (CDN):
		- Tailwind CSS: Utility-first CSS framework for styling
		- Chart.js: Canvas-based charts for reports
		- Google Fonts (Inter): Typography

		IMPACT OF CHANGES:
		- Changing script type from "module" will break ES6 imports
		- Removing/changing CDN URLs will break styling or charts
		- DOM element IDs are referenced in ui.js - changing them breaks functionality

		MAINTAINABILITY:
		- Keep this HTML minimal - business logic belongs in JS modules
		- New features should add modules, not inline scripts
		- DOM structure changes require corresponding updates in ui.js
	-->

	<!-- Load Tailwind CSS -->
	<script src="https://cdn.tailwindcss.com"></script>
	<!-- Load Chart.js for Visualization -->
	<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
	<!-- Configure Font -->
	<style>
		@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

		body {
			font-family: 'Inter', sans-serif;
		}

		.collapse-icon {
			transition: transform 0.2s;
		}

		.rotate-90 {
			transform: rotate(90deg);
		}

		.paused-card {
			border-left: 4px solid #f97316;
		}

		/* Orange-500 */
		.tab-button.active {
			border-bottom: 3px solid #4f46e5;
			/* Indigo-600 */
			color: #1f2937;
			/* Gray-800 */
			font-weight: 600;
		}
	</style>
</head>

<body class="bg-gray-50 min-h-screen p-4 sm:p-8">

	<div id="app" class="max-w-4xl mx-auto bg-white shadow-2xl rounded-xl p-6 sm:p-10">
		<h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">Multi-Task Tracker</h1>

		<!-- Tab Navigation -->
		<div class="flex border-b border-gray-200 mb-6">
			<button id="tab-tracker" data-tab="tracker"
				class="tab-button active flex-1 py-3 text-center text-gray-500 hover:text-gray-800 transition duration-150">
				Time Tracker
			</button>
			<button id="tab-reports" data-tab="reports"
				class="tab-button flex-1 py-3 text-center text-gray-500 hover:text-gray-800 transition duration-150">
				Reports & Analytics
			</button>
		</div>

		<!-- Content Views -->
		<div id="view-tracker" class="content-view">
			<p class="text-sm text-gray-500 mb-6 text-center">Format: <span
					class="font-mono bg-gray-100 p-1 rounded-md">Project / Task</span></p>

			<!-- Smart Activity Input with Datalist -->
			<div class="flex flex-col sm:flex-row gap-3 mb-4">
				<input list="activity-suggestions" type="text" id="topic-input"
					placeholder="Enter Project / Task or select from suggestions"
					class="flex-grow px-4 py-3 border border-gray-300 rounded-lg text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-150">
				<datalist id="activity-suggestions"></datalist>

				<button id="start-button"
					class="w-full sm:w-32 flex-shrink-0 text-white font-semibold py-3 rounded-lg shadow-md bg-indigo-600 hover:bg-indigo-700 transition duration-300 focus:outline-none focus:ring-4 focus:ring-indigo-300 disabled:bg-gray-400">
					Start
				</button>
			</div>

			<p id="error-message" class="text-sm text-red-500 mb-4 h-5"></p>

			<!-- Active Timers Display -->
			<h2 class="text-xl font-semibold text-gray-700 mb-4 border-b pb-2">Active Timers (<span
					id="active-count">0</span>)</h2>

			<div id="active-timers-list" class="space-y-4 mb-8 min-h-[100px] p-2">
				<p id="no-active-message" class="text-gray-500 text-center py-4">No tasks currently running.</p>
			</div>

			<!-- Data Management Section -->
			<div class="mt-8 pt-4 border-t border-gray-200">
				<h2 class="text-xl font-semibold text-gray-700 mb-4">Data Management</h2>
				<button id="export-button"
					class="w-full bg-gray-600 text-white font-semibold py-3 rounded-lg shadow-md transition duration-300 hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-300">
					Export All Data (CSV)
				</button>
			</div>
		</div>

		<div id="view-reports" class="content-view hidden">
			<div id="reports-loading" class="text-center text-gray-500 py-12">Loading historical data...</div>
			<div id="reports-error" class="text-center text-red-500 py-12 hidden">Error loading reports. Check console.</div>

			<div id="reports-content" class="space-y-12 hidden">
				<h3 class="text-2xl font-semibold text-gray-700 border-b pb-2">Time Distribution by Project</h3>
				<div class="flex justify-center h-80">
					<canvas id="project-pie-chart"></canvas>
				</div>

				<h3 class="text-2xl font-semibold text-gray-700 border-b pb-2 pt-6">Daily Time Logged (Last 7 Days)</h3>
				<div class="h-80">
					<canvas id="daily-bar-chart"></canvas>
				</div>
			</div>
		</div>

		<!-- Status and ID Display -->
		<p class="text-sm text-center text-gray-400 mt-6" id="user-id-display">User ID: Loading...</p>
	</div>

	<!--
		ES6 Module Entry Point
		======================
		CRITICAL: type="module" enables ES6 import/export syntax.

		Loading app.js kicks off the entire application:
		1. Loads all other modules via imports
		2. Fetches data from server
		3. Initializes UI
		4. Sets up event listeners

		IMPACT: Removing type="module" or changing src path breaks the entire app.
		The server must serve this with proper MIME type (application/javascript).
	-->
	<script type="module" src="js/app.js"></script>
</body>

</html>
